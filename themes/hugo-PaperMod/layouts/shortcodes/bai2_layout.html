<style>
    /* DÃ²ng nÃ y sáº½ tÃ¬m tiÃªu Ä‘á» chÃ­nh cá»§a trang vÃ  Ä‘á»•i mÃ u */
    .post-single .post-header h1, 
    h1.post-title, 
    .post-header h1 { 
        color: #00abff !important; 
    }

    .post-single {
        line-height: 1.9;
        color: #cbd5e1;
        font-size: 1.1rem;
        text-align: justify;
    }
</style>
<article class="post-single">
    <header class="post-header" style="margin-bottom: 40px;">
        <div class="post-meta" style="color: #94a3b8; font-size: 0.9rem;">
            <span>ğŸ“… 27 ThÃ¡ng 12, 2025</span> â€¢ 
            <span>ğŸ“ 
                <a href="/posts/cate/" 
                style="color: #60a5fa; text-decoration: none !important; font-weight: bold;">
                Java
                </a>
            </span>
        </div>
    </header>

    <div class="post-content" style="line-height: 1.9; color: #cbd5e1; font-size: 1.1rem; border-top: 1px solid #334155; padding-top: 25px; text-align: justify;">
    
    <p>ChÃ o má»«ng cÃ¡c báº¡n Ä‘Ã£ quay trá»Ÿ láº¡i vá»›i series <strong>Láº­p TrÃ¬nh CÃ¹ng Báº£o</strong>! á» bÃ i trÆ°á»›c, chÃºng ta Ä‘Ã£ xÃ¢y dá»±ng thÃ nh cÃ´ng má»™t Server Socket cÆ¡ báº£n. Tuy nhiÃªn, báº¡n cÃ³ nháº­n ra má»™t háº¡n cháº¿ cháº¿t ngÆ°á»i khÃ´ng? ÄÃ³ lÃ  Server cá»§a chÃºng ta chá»‰ cÃ³ thá»ƒ phá»¥c vá»¥ <strong>duy nháº¥t má»™t khÃ¡ch hÃ ng</strong> táº¡i má»™t thá»i Ä‘iá»ƒm. Náº¿u Client A Ä‘ang káº¿t ná»‘i, Client B sáº½ bá»‹ cháº·n Ä‘á»©ng (block) cho Ä‘áº¿n khi Client A ngáº¯t káº¿t ná»‘i.</p>
    
    <p>Trong thá»±c táº¿, má»™t Server chuyÃªn nghiá»‡p pháº£i cÃ³ kháº£ nÄƒng tiáº¿p nháº­n hÃ ng nghÃ¬n káº¿t ná»‘i cÃ¹ng lÃºc. Äá»ƒ lÃ m Ä‘Æ°á»£c Ä‘iá»u Ä‘Ã³, chÃºng ta cáº§n Ä‘áº¿n "phÃ©p phÃ¢n thÃ¢n" trong láº­p trÃ¬nh: <strong>Multi-threading (Äa luá»“ng)</strong>.</p>

    <hr style="border: 0; border-top: 1px solid #334155; margin: 40px 0;">

    <h2 style="color: #60a5fa; margin-top: 30px;">1. Táº¡i sao Server cáº§n Äa luá»“ng?</h2>
    <p>HÃ£y tÆ°á»Ÿng tÆ°á»£ng báº¡n lÃ  chá»§ má»™t tiá»‡m cÃ  phÃª. Náº¿u báº¡n vá»«a lÃ  ngÆ°á»i pha cháº¿, vá»«a lÃ  ngÆ°á»i tÃ­nh tiá»n, khÃ¡ch hÃ ng sáº½ pháº£i xáº¿p hÃ ng ráº¥t dÃ i. Giáº£i phÃ¡p lÃ  gÃ¬? Báº¡n thuÃª thÃªm nhÃ¢n viÃªn. Má»—i nhÃ¢n viÃªn (Thread) sáº½ phá»¥c vá»¥ má»™t khÃ¡ch hÃ ng (Client) riÃªng biá»‡t. Trong Java, quy trÃ¬nh xá»­ lÃ½ Ä‘a luá»“ng cho Socket diá»…n ra nhÆ° sau:</p>
    
    

    <ul style="margin-left: 20px; list-style-type: square; margin-top: 15px;">
        <li><strong>Main Thread:</strong> LuÃ´n tÃºc trá»±c táº¡i cá»•ng (Port) Ä‘á»ƒ láº¯ng nghe yÃªu cáº§u káº¿t ná»‘i báº±ng lá»‡nh <code>accept()</code>.</li>
        <li><strong>Worker Thread:</strong> Ngay khi cÃ³ Client káº¿t ná»‘i, Main Thread sáº½ "Ä‘áº»" ra má»™t Thread má»›i vÃ  bÃ n giao Client cho Thread nÃ y xá»­ lÃ½.</li>
        <li><strong>Looping:</strong> Sau khi bÃ n giao, Main Thread láº­p tá»©c quay láº¡i tráº¡ng thÃ¡i láº¯ng nghe Ä‘á»ƒ chá» khÃ¡ch hÃ ng tiáº¿p theo.</li>
    </ul>

    <h2 style="color: #60a5fa; margin-top: 40px;">2. Triá»ƒn khai Worker Thread </h2>
    <p>ChÃºng ta sáº½ tÃ¡ch logic xá»­ lÃ½ Client sang má»™t Class riÃªng káº¿ thá»«a tá»« <code>Thread</code> hoáº·c implement <code>Runnable</code>. á» Ä‘Ã¢y, mÃ¬nh sá»­ dá»¥ng <code>Runnable</code> Ä‘á»ƒ Ä‘áº£m báº£o tÃ­nh linh hoáº¡t cho mÃ£ nguá»“n.</p>

    <h3 style="color: #f89820; margin-bottom: 15px;">BÆ°á»›c 1: Class xá»­ lÃ½ tá»«ng Client (ClientHandler.java)</h3>
    <div style="background: #1e293b; padding: 20px; border-radius: 8px; border: 1px solid #334155; overflow-x: auto; margin-bottom: 25px;">
<pre style="margin: 0; font-family: 'JetBrains Mono', monospace; font-size: 0.95rem; line-height: 1.5; color: #e2e8f0;">
import java.io.*;
import java.net.*;

public class ClientHandler implements Runnable {
    private Socket clientSocket;

    public ClientHandler(Socket socket) {
        this.clientSocket = socket;
    }

    @Override
    public void run() {
        try (
            BufferedReader input = new BufferedReader(new InputStreamReader(clientSocket.getInputStream()));
            PrintWriter output = new PrintWriter(clientSocket.getOutputStream(), true)
        ) {
            System.out.println("LOG: Handling client on thread " + Thread.currentThread().getName());
            
            String message;
            while ((message = input.readLine()) != null) {
                System.out.println("RECEIVED: " + message);
                output.println("SERVER_ECHO: " + message.toUpperCase());
                if (message.equalsIgnoreCase("exit")) break;
            }
        } catch (IOException e) {
            System.err.println("HANDLER ERROR: " + e.getMessage());
        } finally {
            try { clientSocket.close(); } catch (IOException e) {}
            System.out.println("LOG: Client disconnected.");
        }
    }
}</pre>
    </div>

    <h3 style="color: #00abff; margin-bottom: 15px;">BÆ°á»›c 2: Server Ä‘a luá»“ng chÃ­nh (MultiThreadedServer.java)</h3>
    <p>Trong Server nÃ y, chÃºng ta dÃ¹ng vÃ²ng láº·p <code>while(true)</code> Ä‘á»ƒ cháº¥p nháº­n káº¿t ná»‘i liÃªn tá»¥c.</p>
    <div style="background: #1e293b; padding: 20px; border-radius: 8px; border: 1px solid #334155; overflow-x: auto; margin-bottom: 25px;">
<pre style="margin: 0; font-family: 'JetBrains Mono', monospace; font-size: 0.95rem; line-height: 1.5; color: #e2e8f0;">
import java.io.*;
import java.net.*;

public class MultiThreadedServer {
    public static void main(String[] args) {
        int port = 5000;
        try (ServerSocket serverSocket = new ServerSocket(port)) {
            System.out.println("LOG: Multi-threaded Server started on port " + port);

            while (true) {
                Socket socket = serverSocket.accept();
                System.out.println("LOG: New client detected!");
                
                // Create a new thread for each client
                ClientHandler handler = new ClientHandler(socket);
                Thread thread = new Thread(handler);
                thread.start();
            }
        } catch (IOException e) {
            System.err.println("SERVER CRITICAL ERROR: " + e.getMessage());
        }
    }
}</pre>
    </div>

<h2 style="color: #60a5fa; margin-top: 40px;">3. Kiá»ƒm tra tÃ­nh nÄƒng "Song HÃ nh"</h2>
<p>Äá»ƒ tháº¥y Ä‘Æ°á»£c sá»©c máº¡nh cá»§a bÃ i nÃ y so vá»›i bÃ i 1, báº¡n hÃ£y thá»±c hiá»‡n bÃ i test sau:</p>
<ol style="margin-left: 20px; margin-bottom: 25px;">
    <li style="margin-bottom: 10px;">Cháº¡y <strong>MultiThreadedServer</strong>.</li>
    <li style="margin-bottom: 10px;">Má»Ÿ <strong>3 Terminal khÃ¡c nhau</strong> vÃ  cháº¡y 3 Client Ä‘á»“ng thá»i (sá»­ dá»¥ng code MyClient tá»« bÃ i 1).</li>
    <li style="margin-bottom: 10px;">Gá»­i tin nháº¯n tá»« cáº£ 3 Terminal. Báº¡n sáº½ tháº¥y Server pháº£n há»“i ngay láº­p tá»©c cho cáº£ 3 mÃ  khÃ´ng cáº§n chá» Ä‘á»£i!</li>
</ol>



<h2 style="color: #60a5fa; margin-top: 40px;">4. Tá»•ng káº¿t vÃ  Cáº£nh bÃ¡o</h2>
<p>ChÃºc má»«ng Báº£o! Báº¡n Ä‘Ã£ nÃ¢ng cáº¥p Server cá»§a mÃ¬nh lÃªn má»™t táº§m cao má»›i. Tuy nhiÃªn, <strong>"Quyá»n lá»±c cÃ ng cao, trÃ¡ch nhiá»‡m cÃ ng lá»›n"</strong>. Khi lÃ m viá»‡c vá»›i Ä‘a luá»“ng, báº¡n cáº§n lÆ°u Ã½:</p>
<ul style="margin-left: 20px; list-style-type: square;">
    <li><strong>Resource Management:</strong> Náº¿u cÃ³ 10.000 Client, viá»‡c táº¡o 10.000 Thread sáº½ khiáº¿n RAM bá»‹ cáº¡n kiá»‡t. á» cÃ¡c bÃ i nÃ¢ng cao, chÃºng ta sáº½ dÃ¹ng <code>Thread Pool</code> Ä‘á»ƒ giá»›i háº¡n sá»‘ lÆ°á»£ng Thread.</li>
    <li><strong>Thread Safety:</strong> Náº¿u nhiá»u Thread cÃ¹ng ghi vÃ o má»™t file hoáº·c má»™t Database, dá»¯ liá»‡u sáº½ bá»‹ loáº¡n. LÃºc Ä‘Ã³ ta cáº§n dÃ¹ng Ä‘áº¿n <code>synchronized</code>.</li>
</ul>

<p style="margin-top: 15px;">BÃ i viáº¿t tá»›i, Báº£o sáº½ hÆ°á»›ng dáº«n cÃ¡c báº¡n bÆ°á»›c vÃ o tháº¿ giá»›i lÆ°u trá»¯: <strong>LÃ m sao Ä‘á»ƒ Server lÆ°u thÃ´ng tin khÃ¡ch hÃ ng vÃ o Database (MySQL)?</strong> Äá»«ng bá» lá»¡ nhÃ©!</p>

<hr style="border: 0; border-top: 1px solid #334155; margin: 40px 0;">

<p style="margin-top: 40px; font-weight: bold; display: flex; flex-wrap: wrap; gap: 18px;">
    <a href="/" style="color: #60a5fa; text-decoration: none !important; transition: 0.3s;" onmouseover="this.style.color='#f8fafc'" onmouseout="this.style.color='#60a5fa'">#Láº­pTrÃ¬nhCÃ¹ngBáº£o</a>
    <a href="/posts/bai-2/" style="color: #60a5fa; text-decoration: none !important; transition: 0.3s;" onmouseover="this.style.color='#f8fafc'" onmouseout="this.style.color='#60a5fa'">#JavaMultiThread</a>
    <a href="/posts/cate/" style="color: #60a5fa; text-decoration: none !important; transition: 0.3s;" onmouseover="this.style.color='#f8fafc'" onmouseout="this.style.color='#60a5fa'">#Há»cBackend</a>
    <a href="/tips/" style="color: #60a5fa; text-decoration: none !important; transition: 0.3s;" onmouseover="this.style.color='#f8fafc'" onmouseout="this.style.color='#60a5fa'">#Concurrency</a>
</p>
</div>
</article>